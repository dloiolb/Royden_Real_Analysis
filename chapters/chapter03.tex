% Chapter 3
\chapter{Lebesgue Measurable Functions}

% 3.1
\section{Sums, Products, and Compositions}
\begin{flushleft}
    \begin{namedthm*}{Proposition 1}
        Let the function $f$ have a measurable domain $E$. Then the following statements are equivalent:
        \begin{enumerate}[label=(\roman*),align=left]
            \item For each real number $c$, the set $\{x\in E\ |\ f(x)>c\}$ is measurable.
            \item For each real number $c$, the set $\{x\in E\ |\ f(x)\ge c\}$ is measurable.
            \item For each real number $c$, the set $\{x\in E\ |\ f(x)<c\}$ is measurable.
            \item For each real number $c$, the set $\{x\in E\ |\ f(x)\le c\}$ is measurable.
        \end{enumerate}
        Each of these properties implies that for each extended real number $c$,
        \begin{center}
            the set $\{x\in E\ |\ f(x)= c\}$ is measurable.
        \end{center}
    \end{namedthm*}

    \begin{namedthm*}{Definition}
        An extended real-valued function $f$ defined on $E$ is said to be \textbf{Lebesgue measurable}, or simply \textbf{measurable}, provided its domain $E$ is measurable and it satisfies one of the four statements of Proposition 1.        
    \end{namedthm*}

\begin{namedthm*}{Proposition 2}
    Let the real-valued function $f$ be defined on a measurable set $E$.
    Then the function $f$ is measurable iff for each open set $\mathcal{O}$, the inverse image of $\mathcal{O}$ under f, $f^{-1}(\mathcal{O})=\{x\in E\ |\ f(x)\in\mathcal{O}\}$, is a measurable set.
\end{namedthm*}
\begin{proof}
    Let $f:E\to\mathbb{R}$, where $E$ is a measurable set.\\
    $(\implies)$ Suppose that $f$ is measurable.\\
    Let $\mathcal{O}$ be open. Then by Chapter 1, Proposition 9, $\mathcal{O}$ can be written as the countable disjoint union of open intervals: $\mathcal{O}=\bigcup_{k=1}^\infty I_k$.
    We can construct these intervals in the following form:
    \[
        I_k=(a_k,b_k)=(-\infty,b_k)\cap(a_k,\infty)  
    \] 
    Therefore we see that
    \begin{align*}
        f^{-1}(\mathcal{O})&=f^{-1}(\bigcup_{k=1}^\infty I_k)\\
        &=f^{-1}(\bigcup_{k=1}^\infty (-\infty,b_k)\cap(a_k,\infty))\\
        &=\bigcup_{k=1}^\infty f^{-1}((-\infty,b_k)\cap(a_k,\infty))\\
        &=\bigcup_{k=1}^\infty f^{-1}(-\infty,b_k)\cap f^{-1}(a_k,\infty).
    \end{align*}
    Because $f$ is measurable, we see that $f^{-1}((-\infty,b_k))$ and $f^{-1}((a_k,\infty))$ are measurable sets, and countable union and intersection of measurable sets is also a measurable set, so $f^{-1}(\mathcal{O})$ is a measurable set.
    \\$(\impliedby)$ Suppose that for each open set $\mathcal{O}$, $f^{-1}(\mathcal{O})$ is a measurable set.\\
    Because for any real number $c$, the interval of the form $(c,\infty)$ is an open set, and therefore we have that the set $f^{-1}((c,\infty))=\{x\in E\ |\ f(x)\in(c,\infty)\}=\{x\in E\ |\ f(x)>c\}$ is measurable, which implies that $f$ is measurable.
\end{proof}

\begin{namedthm*}{Proposition 5}
    Let $f$ be an extended real-valued function on the measurable set $E$.
    \begin{enumerate}[label=(\roman*),align=right]
        \item If $f$ is measurable on $E$ and $f=g$ a.e. on $E$, then $g$ is measurable on $E$.
        \item For a measurable subset $D$ of $E$, $f$ is measurable on $E$ iff the restrictions of $f$ to $D$ and $E\setminus D$ are measurable.
    \end{enumerate}
\end{namedthm*}
\begin{proof}
    Let $f$ be an extended real-valued function on the measurable set $E$.
    \begin{enumerate}[label=(\roman*),align=right]
        \item Let $f$ be measurable on $E$ and $f=g$ a.e. on $E$.\\
        Define $A=\{x\in E\ |\ f(x)\neq g(x)\}\subseteq E$, so that $f=g$ on $E\setminus A$, and $m(A)=0$.
        \begin{align*}
            \{x\in E\ |\ g(x)>c\}&=(\{x\in E\ |\ g(x)>c\}\cap[E\cap A])\cup(\{x\in E\ |\ g(x)>c\}\cap[E\cap A^c])\\
            &=\{x\in A\ |\ g(x)>c\}\cup(\{x\in E\ |\ f(x)>c\}\cap[E\setminus A]).
        \end{align*}
        Now, $\{x\in A\ |\ g(x)>c\}\subseteq A$, and because $m(A)=0$, $\{x\in A\ |\ g(x)>c\}$ is measurable and has measure zero.
        The set $\{x\in E\ |\ f(x)>c\}$ is measurable because $f$ is measurable, and $E\cap A^c$ is measurable because $E$ and $A$ (and thus $A^c$) are measurable.
        Thus $\{x\in E\ |\ g(x)>c\}$ is measurable because it is the finite union and intersection of measurable sets; therefore $g$ is measurable on $E$.
        \item Let $D$ be a measurable subset of $E$.\\
        $(\implies)$ Suppose $f$ is measurable on $E$.\\
        Then for any real number $c$, we see that 
        \begin{align*}
            \{x\in D\ |\ f|_{D}(x)>c\}&=\{x\in E\ |\ f(x)>c\}\cap[E\cap D],\\
            \{x\in E\setminus D\ |\ f|_{E\setminus D}(x)>c\}&=\{x\in E\ |\ f(x)>c\}\cap[E\setminus D],
        \end{align*}
        where both are measurable because they are each intersections of measurable sets. Therefore the restrictions $f|_{D}$ and $f|_{E\setminus D}$ are measurable.\\
        $(\impliedby)$ Suppose the restrictions of $f$ to $D$ and $E\setminus D$ are measurable.\\
        Then for any real number $c$,
        \begin{align*}
            \{x\in E\ |\ f(x)>c\}&=\{x\in D\ |\ f|_{D}(x)>c\}\cup\{x\in E\setminus D\ |\ f|_{E\setminus D}(x)>c\},
        \end{align*}
        which is measurable because it is a union of measurable sets.
    \end{enumerate}
\end{proof}

\end{flushleft}
\begin{center}
	\textbf{PROBLEMS}
\end{center}
\begin{enumerate}
	\setcounter{enumi}{0}
	\item Suppose $f$ and $g$ are continuous functions on $[a,b]$. Show that if $f=g$ a.e. on $[a,b]$, then, in fact, $f=g$ on $[a,b]$.
    Is a similar assertion true if $[a,b]$ is replaced by a general measurable set $E$?\\
    \\Let $f,g$ be continuous functions on $[a,b]$, where $f=g$ on $[a,b]\setminus E_0$, where $E_0$ is a subset of $[a,b]$ and $m(E_0)=0$.
    \\Suppose that $E_0$ is nonempty.\\
    Consider any point $x_0\in E_0\subseteq[a,b]$. For any $\epsilon>0$, there exists a $c\in(x_0-\epsilon,x_0+\epsilon)\cap[a,b]$ such that $f(c)=g(c)$, else we reach a contradiction because $m((x_0-\epsilon,x_0+\epsilon)\cap[a,b])\neq0$.
    This means that we can construct a sequence $\{c_i\}_{i=1}^\infty$ that converges to $x_0$, where $f(c_i)=g(c_i)$ is defined for all $i$. 
    However, because $\{c_i\}\to x_0$, by continuity of $f,g$, we have $\{f(c_i)\}\to f(x_0)$ and $\{g(c_i)\}\to g(x_0)$, and because $f(c_i)=g(c_i)$ for all $i$, the limit is unique; that is,
    \[
        |f(x_0)-g(x_0)|\le|f(x_0)-f(c_i)|+|f(c_i)-g(x_0)|<\epsilon,
    \]
    and $f(x_0)=g(x_0)$.
    \\However, this is a contradiction to $f(x)\neq g(x)$ for all $x\in E_0$, and so $E_0=\emptyset$.\\
    \\In the case that $[a,b]$ is replaced by a general measurable set $E$, the assertion is not true.
    Consider the case where $E=\{a\}$, so that $f,g$ are continuous on $\{a\}$, and $f=g$ a.e. on $\{a\}$.
    This only implies that $f=g$ on $E$ except for a set of measure zero. But $E$ is already of measure zero, so $f(a)\neq g(a)$ is possible, and $f\neq g$ on $E$.
    \item Let $D$ and $E$ be measurable sets and $f$ a function with domain $D\cup E$. We proved that $f$ is measurable on $D\cup E$ iff its restrictions to $D$ and $E$ are measurable.
    Is the same true if "measurable" is replaced by "continuous"?\\
    \\No; consider the function $f:[-1,1]\to\mathbb{R}$, where $[-1,1]=[-1,0)\cup[0,1]$, and we define
    \[
    f(x)=
    \begin{cases}
        0&x\in[-1,0),\\
        1&x\in[0,1].
    \end{cases}    
    \]
    Clearly we have a point of discontinuity at $x=0$, so $f$ is not continuous even though $f|_{[-1,0)}$ and $f|_{[0,1]}$ are continuous.
    \item Suppose a function $f$ has a measurable domain and is continuous except at a finite number of points.
    Is $f$ necessarily measurable?\\
    \\Yes; let $f$ be a function on the measurable domain $E$, and suppose $f$ is continuous on $E\setminus E_0$, where $E_0=\{x_i\}_{i=1}^n \subseteq E$. Then $m(E_0)=0$ because countable sets are measurable and have measure zero.
    \\Now, $f|_{E\setminus E_0}$ is continuous and therefore measurable (Proposition 3), and $f|_{E_0}$ is defined on a set of measure zero, so any subset $\{x\in E_0\ |\ f|_{E_0}(x)>c\}\subseteq E_0$ has measure zero and is thus measurable, and therefore $f|_{E_0}$ is a measurable function.
    \\Recall Proposition 5 to see that for the measurable subset $E_0$ of $E$, $f$ is measurable because $f|_{E_0}$ and $f|_{E\setminus E_0}$ are both measurable functions.
    \item Suppose $f$ is a real-valued function on $\mathbb{R}$ such that $f^{-1}(c)$ is measurable for each number $c$. Is $f$ necessarily measurable?\\
    \\No; let $V\subseteq[0,1]$ be a Vitali set. Therefore $V$ is nonmeasurable (see Ch 2.6).
    Consider the function $f:\mathbb{R}\to\mathbb{R}$, defined as
    \[
        f(x)=
        \begin{cases}
            -e^x&x\in V\\
            e^x&x\notin V\\
        \end{cases}    
    \]
    For any real number $c$, we have
    \[
        f^{-1}(c)=
        \begin{cases}
            \ln(-c)& c<0\\
            \ln(c)& c>0\\
            \emptyset& c=0
        \end{cases}
    \]
    and so $f^{-1}(c)$ is a singleton set or is the empty set, which are measurable, so $f^{-1}(c)$ is measurable.\\
    Now, we know that $e^x:\mathbb{R}\to\mathbb{R}_{>0}$ and so $e^x>0$ for any real number $x$.\\
    Therefore $f(x)=-e^x<0$ only when $x\in V$.
    However, the set $\{x\in\mathbb{R}\ |\ f(x)<0\}=V$ is not measurable, and so $f$ is not a measurable function.
    \item Suppose the function $f$ is defined on a measurable set $E$ and $\{x\in E\ |\ f(x)>c\}$ is a measurable set for each rational number $c$. Is $f$ necessarily a measurable function?\\
    \\Yes. Let $f:E\to\mathbb{R}$ with $E$ a measurable set, and let $\{x\in E\ |\ f(x)>c\}=\{x\in E\ |\ f(x)\in(c,\infty)\}$ be measurable for each $c\in\mathbb{Q}$.\\
    Let $a$ be any real number. Then for any natural number $n$, there exists a rational number $c_n$ such that $a<c_n<a+\frac{1}{n}$, and therefore $\bigcup_{n=1}^\infty(c_n,\infty)=(a,\infty)$.
    Therefore we have
    \begin{align*}
        \{x\in E\ |\ f(x)>a\} &= f^{-1}((a,\infty))\\
        &=f^{-1}(\bigcup_{n=1}^\infty(c_n,\infty))\\
        &=\bigcup_{n=1}^\infty f^{-1}((c_n,\infty))\\
        &=\bigcup_{n=1}^\infty \{x\in E\ |\ f(x)>c_n\},
    \end{align*}
    which is a countable union of measurable sets, and therefore is also measurable.
    \item Let $f$ be a function with measurable domain $D$. Show that $f$ is measurable iff the function $g$ defined on $\mathbb{R}$ by $g(x)=f(x)$ for $x\in D$ and $g(x)=0$ for $x\notin D$ is measurable.\\
    \\Let $D\subseteq\mathbb{R}$ be a measurable set, let $f:D\to\mathbb{R}$, and let $g:\mathbb{R}\to\mathbb{R}$ be defined by
    \[
        g(x)=
        \begin{cases}
            f(x)&x\in D\\
            0&x\notin D
        \end{cases}
    \]
    $(\implies)$ Suppose that $f$ is measurable.\\
    For any real number $c$,
    \[
        \{x\in \mathbb{R}\ |\ g(x)>c\}=
        \begin{cases}
            \{x\in D\ |\ f(x)>c\}&c\ge0\\
            \{x\in D\ |\ f(x)>c\}\cup D^c&c<0\\
        \end{cases}
    \]
    Both of the sets $\{x\in D\ |\ f(x)>c\}$ and $\{x\in D\ |\ f(x)>c\}\cap D^c$ are measurable, so $ \{x\in \mathbb{R}\ |\ g(x)>c\}$ is measurable and thus $g$ is a measurable function.\\
    \\$(\impliedby)$ Suppose that $g$ is measurable.\\
    Recall Proposition 5 (ii) to see that for the measurable subset $D$ of $\mathbb{R}$, $g$ is measurable on $\mathbb{R}$, which implies that the restrictions $g|_{D}$ and $g|_{\mathbb{R}\setminus D}$ are measurable.
    Therefore for any real number $c$,
    \begin{align*}
        \{x\in D\ |\ f(x)>c\}&=\{x\in \mathbb{R}\ |\ g|_{D}(x)>c\}\cap D\text{ is measurable},
    \end{align*}
    and $f$ is measurable.
    \item Let the function $f$ be defined on a measurable set $E$. Show that $f$ is measurable iff for each borel set $A$, $f^{-1}(A)$ is measurable. (Hint: the collection of sets $A$ that have the property that $f^{-1}(A)$ is measurable is a $\sigma$-algebra.)\\
    \\Let $f:E\to\mathbb{R}$, where $E$ is a measurable set.\\
    $(\implies$) Suppose that $f$ is measurable.\\
    Let $\mathcal{M}=\{A\ |\ f^{-1}(A)\text{ is measurable}\}$.\\
    To show that $\mathcal{M}$ is a $\sigma$-algebra, know that the measurable sets is a $\sigma$-algebra.\\
	Observe that:
	\begin{enumerate}[label=(\roman*),align=left]
		\item $f^{-1}(\emptyset)=\emptyset\implies\emptyset\in \mathcal{M}$.
		\item $A\in \mathcal{M}\implies f^{-1}(A)\text{ is measurable }\implies f^{-1}(A)^c=f^{-1}(A^c)\text{ is measurable }\implies A^c\in \mathcal{M}$.
		\item $A_k\in \mathcal{M}\implies f^{-1}(A_k)\text{ is measurable }\implies\bigcup_{k=1}^\infty f^{-1}(A_k)=f^{-1}(\bigcup_{k=1}^\infty A_k)\text{ is measurable }\implies \bigcup_{k=1}^\infty A_k\in \mathcal{M}$.
	\end{enumerate}
    Then because $f$ is measurable, for any real number $a$, the set $f^{-1}((a,\infty))=\{x\in E\ |\ f(x)>a\}$ is measurable.
    Now, $(a,\infty)\in\mathcal{M}$ because $f^{-1}((a,\infty))$ is measurable.
    Because $(a,\infty)$ is a Borel set, all other Borel sets are in $\mathcal{M}$ because the Borel sets are a $\sigma$-algebra.\\
    \\$(\impliedby$) Suppose that for each borel set $A$, the set $f^{-1}(A)=\{x\in E\ |\ f(x)\in A\}$ is measurable.\\
    Every interval of the form $(a,\infty)$ is a borel set, so we have that for any real number $a$, the set $f^{-1}((a,\infty))=\{x\in E\ |\ f(x)>a\}$ is measurable. This is equivalent to the measurability of $f$.
    \item (Borel measurability) A function $f$ is said to be \textbf{Borel measurable} provided its domain $E$ is a Borel set and for each $c$, the set $\{x\in E\ |\ f(x)>c\}$ is a Borel set.
    Verify that Proposition 1 and Theorem 6 remain valid if we replace "(Lebesgue) measurable set" by "Borel set".
    Show that:
    \begin{enumerate}[label=(\roman*),align=left]
        \item every Borel measurable function is Lebesgue measurable,\\
        \\The Borel sets are a subset of the measurable sets.
        Therefore for a Borel measurable function $f$, its domain $E$ is a Borel set (and thus a measurable set), and for each $c$, the set $\{x\in E\ |\ f(x)>c\}$ is a Borel set (and thus a measurable set).
        Thus $f$ is a measurable function.
        \item if $f$ is Borel measurable and $B$ is a Borel set, then $f^{-1}(B)$ is a Borel set,\\
        \\Let $S=\{B\ |\ f^{-1}(B)\text{ is Borel}\}$.\\
        To show that $S$ is a $\sigma$-algebra, know that the Borel sets is a $\sigma$-algebra.\\
        Observe that:
        \begin{enumerate}[label=(\roman*),align=left]
            \item $f^{-1}(\emptyset)=\emptyset\implies\emptyset\in S$.
            \item $B\in S\implies f^{-1}(B)\text{ is Borel }\implies f^{-1}(B)^c=f^{-1}(B^c)\text{ is Borel }\implies B^c\in S$.
            \item $B_k\in S\implies f^{-1}(B_k)\text{ is Borel }\implies\bigcup_{k=1}^\infty f^{-1}(B_k)=f^{-1}(\bigcup_{k=1}^\infty B_k)\text{ is Borel }\implies \bigcup_{k=1}^\infty B_k\in S$.
        \end{enumerate}
        Now, because $f$ is Borel measurable, for any real number $a$, the set $f^{-1}((a,\infty))$ is a Borel set.
        This implies $(a,\infty)\in S$.
        Because $(a,\infty)$ is a Borel set, all other Borel sets are in $S$ because the Borel sets is a $\sigma$-algebra.
        \item if $f$ and $g$ are Borel measurable, so is $f\circ g$,\\
        \\Let $f,g$ be Borel measurable, with $g:E\to F$, and $f:F\to\mathbb{R}$, where $E,F$ are Borel sets. 
        Then $f\circ g:E\to\mathbb{R}$ has a Borel set as its domain.\\
        Recall that $\{x\ |\ f(x)>a\}=\{x\ |\ f(x)\in(a,\infty)\}=f^{-1}((a,\infty))$.
        \begin{align*}
            \{x\ |\ (f\circ g )(x)>a\}&=\{x\ |\ (f\circ g )(x)\in(a,\infty)\}\\
            &=(f\circ g )^{-1}((a,\infty))\\
            &=(g^{-1}\circ f^{-1})((a,\infty))\\
            &=g^{-1}(f^{-1}((a,\infty)))\\
            &=g^{-1}(B)&&\text{ where }B\text{ is Borel}\\
            &=B'.&&\text{ where }B'\text{ is Borel}
        \end{align*}
        Therefore $f\circ g$ is Borel measurable.
        \item if $f$ is Borel measurable and $g$ is Lebesgue measurable, then $f\circ g$ is Lebesgue measurable.\\
        \\Let $f$ be Borel measurable, with $f:F\to\mathbb{R}$, and let $g$ be Lebesgue measurable, with $g:E\to F$, where $F$ is a Borel set and $E$ is a measurable set. 
        Then $f\circ g:E\to\mathbb{R}$ has a measurable set as its domain.
        \begin{align*}
            \{x\ |\ (f\circ g )(x)>a\}&=\{x\ |\ (f\circ g )(x)\in(a,\infty)\}\\
            &=(f\circ g )^{-1}((a,\infty))\\
            &=(g^{-1}\circ f^{-1})((a,\infty))\\
            &=g^{-1}(f^{-1}((a,\infty)))\\
            &=g^{-1}(B)&&\text{ where }B\text{ is Borel}\\
            &=B'.&&\text{ where }B'\text{ is measurable (Problem 7)}
        \end{align*}
        Therefore $f\circ g$ is Lebesgue measurable.
    \end{enumerate}
    \item Let $\{f_n\}$ be a sequence of measurable functions defined on a measurable set $E$.
    Define $E_0$ to be the set of points of $x$ in $E$ at which $\{f_n(x)\}$ converges. Is the set $E_0$ measurable?\\
    \\Let $E_0=\{x\in E\ |\ \{f_n(x)\}\text{ converges}\}\subseteq \{x\in E\ |\ \{f_n(x)\}\text{ is Cauchy}\}$, because all convergent sequences are Cauchy.
    \\Therefore $E_0=\{x\in E\ |\ \forall k\in\mathbb{N},\exists N\in\mathbb{N}\text{ such that }|f_n(x)-f_m(x)|<\frac{1}{k}\text{ for all }n,m\ge N\}$.
    \\This is equivalent to writing 
    \[
        E_0=\bigcap_{k\in\mathbb{N}}\bigcup_{N\in\mathbb{N}}\bigcap_{n,m\ge N}\{x\in E\ |\ |f_n(x)-f_m(x)|<\frac{1}{k}\}.
    \]
    The functions $f_n$ and $f_m$ are measurable, so by Theorem 6, $f_n-f_m$ is also measurable.
    The absolute value function $|\cdot|$ is continuous, so by Proposition 7, the composition $|\cdot|\circ(f_n-f_m)=|f_n-f_m|$ is a measurable function.
    Therefore for the real number $\frac{1}{k}$, the set $\{x\in E\ |\ |f_n(x)-f_m(x)|<\frac{1}{k}\}$ is a measurable set.\\
    Then $E_0$ is a countable union and intersection of measurable sets, so $E_0$ is measurable.
    \item Suppose $f$ and $g$ are real-valued functions defined on all of $\mathbb{R}$, $f$ is measurable, and $g$ is continuous.
    Is the composition $f\circ g$ necessarily measurable?\\
    \\No; let $f$ be measurable, with $f:\mathbb{R}\to\mathbb{R}$, and let $g$ be continuous, with $g:\mathbb{R}\to \mathbb{R}$.
        Then $f\circ g:\mathbb{R}\to\mathbb{R}$.
        \begin{align*}
            \{x\ |\ (f\circ g )(x)>a\}&=\{x\ |\ (f\circ g )(x)\in(a,\infty)\}\\
            &=(f\circ g )^{-1}((a,\infty))\\
            &=(g^{-1}\circ f^{-1})((a,\infty))\\
            &=g^{-1}(f^{-1}((a,\infty)))\\
            &=g^{-1}(A)&&\text{ where }A\text{ is measurable}
        \end{align*}
        Recall Chapter 2 Problem 36 to see that for a continuous function $g$, the set $g^{-1}(A)$ is not always measurable when $A$ is measurable.
    \item Let $f$ be a measurable function and $g$ be a one-to-one function from $\mathbb{R}$ onto $\mathbb{R}$ which has a Lipschitz inverse. Show that the composition $f\circ g$ is measurable. (Hint: examine Problem 37 in Chapter 2.)\\
    \\Let $f$ be measurable, with $f:\mathbb{R}\to\mathbb{R}$, and let $g$ be a bijection from $\mathbb{R}$ to $\mathbb{R}$, where $g^{-1}$ is Lipschitz.
    From Chapter 2 Problem 37, we have that $g^{-1}$ maps a measurable set to a measurable set; that is, for the measurable set $A$, the set $g^{-1}(A)$ is measurable.
    \\We have $f\circ g:\mathbb{R}\to\mathbb{R}$.
    \begin{align*}
        \{x\ |\ (f\circ g )(x)>a\}&=\{x\ |\ (f\circ g )(x)\in(a,\infty)\}\\
        &=(f\circ g )^{-1}((a,\infty))\\
        &=(g^{-1}\circ f^{-1})((a,\infty))\\
        &=g^{-1}(f^{-1}((a,\infty)))\\
        &=g^{-1}(A)&&\text{ where }A\text{ is measurable}\\
        &=A'.&&\text{ where }A'\text{ is measurable (Chapter 2 Problem 37)}
    \end{align*}
    Therefore $f\circ g$ is measurable.
\end{enumerate}

% 3.2
\section{Sequential Pointwise Limits and Simple Approximation}
\begin{flushleft}
    \begin{namedthm*}{Definition}
        For a sequence $\{f_n\}$ of functions with common domain $E$, a function $f$ on $E$, and a subset $A$ of $E$, we say that  
        \begin{enumerate}[label=(\roman*),align=left]
            \item The sequence $\{f_n\}$ converges to $f$ pointwise on $A$ provided
            \[
                \lim_{n\to\infty}f_n(x)=f(x)\text{ for all }x\in A.
            \]
            a.k.a.
            \[
                \forall x\in A, \forall\epsilon>0, \exists N_x\in\mathbb{N}:\forall n\ge N_x, |f_n(x)-f(x)|<\epsilon.
            \]
            \item The sequence $\{f_n\}$ converges to $f$ pointwise a.e. on $A$ provided it converges to $f$ pointwise on $A\setminus B$, where $m(B)=0$.
            \item The sequence $\{f_n\}$ converges to $f$ uniformly on $A$ provided for each $\epsilon>0$, there is an index $N$ for which
            \[
                |f-f_n|<\epsilon\text{ on }A\text{ for all }n\ge N.    
            \]
            a.k.a.
            \[
                \forall\epsilon>0, \exists N\in\mathbb{N}:\forall n\ge N,\forall x\in A, |f_n(x)-f(x)|<\epsilon.
            \]
        \end{enumerate}
    \end{namedthm*}

    \begin{namedthm*}{Theorem}
        Let $A\subseteq\mathbb{R}^n$ and suppose $\{f_i\}$ is a sequence of functions $f_i:A\to\mathbb{R}^m$ such that 
        \begin{enumerate}[label=(\roman*),align=left]
            \item $\{f_i\}\to f$ uniformly on $A$
            \item Each $f_i$ is uniformly continuous on $A$.
        \end{enumerate}
        Then $f:A\to\mathbb{R}^m$ is uniformly continuous on $A$.
    \end{namedthm*}
    \begin{proof}
        Fix $\epsilon>0$.\\
        By (i), there exists an $N\in\mathbb{N}$ such that for all $n\ge N$, for all $x\in A$, $\|f_n(x)-f(x)\|<\epsilon/3$.
        \\Now, fix $N$ and fix $k\ge N$.\\
        By (ii), there exists a $\delta>0$ such that for all $x,y\in A$ with $\|x-y\|<\delta$, then $\|f_k(x)-f_k(y)\|<\epsilon/3$.
        \\Therefore we have
        \begin{align*}
            \|f(x)-f(y)\|&=\|f(x)-f_k(x)+f_k(x)-f_k(y)+f_k(y)-f(y)\|\\
            &\le\|f(x)-f_k(x)\|+\|f_k(x)-f_k(y)\|+\|f_k(y)-f(y)\|\\
            &<\frac{\epsilon}{3}+\frac{\epsilon}{3}+\frac{\epsilon}{3}\\
            &=\epsilon.
        \end{align*}
        Therefore for all $\epsilon>0$, there exists a $\delta>0$ such that for all $x,y \in A$ with $\|x-y\|<\delta$, then $\|f(x)-f(y)\|<\epsilon$.
        Thus $f$ is uniformly continuous on $A$.\\
        A similar proof can show this for a sequence of continuous functions converging uniformly to a continuous function.
    \end{proof}

    \begin{namedthm*}{Example}
        Consider the sequence of continuous functions $\{f_n\}_{n=2}^\infty:[0,1]\to\mathbb{R}$, defined by
        \[ 
		f_n(x) =
            \begin{cases} 
                \frac{n-0}{1/n-0}x& \text{ if } x \in [0,\frac{1}{n}]\\
                \frac{0-n}{2/n-1/n}(x-\frac{1}{n})+n & \text{ if } x \in (\frac{1}{n},\frac{2}{n}]\\
                0& \text{ if } x \in (\frac{2}{n},1]
            \end{cases}
            =
            \begin{cases} 
                n^2x& \text{ if } x \in [0,\frac{1}{n}]\\
                -n^2(x-\frac{1}{n})+n & \text{ if } x \in (\frac{1}{n},\frac{2}{n}]\\
                0& \text{ if } x \in (\frac{2}{n},1]
            \end{cases}
	    \]
        (Each $f_n$ is a triangle-shaped function that achieves its max $f(1/n)=n$ and base corners $f(0)=0$ and $f(2/n)=0$.)\\
        In addition, consider the continuous function $f:[0,1]\to\mathbb{R}$ defined by $f(x)=0$ for all $x\in[0,1]$.\\
        The sequence $\{f_n\}$ converges to $f$ pointwise but not uniformly on $[0,1]$.
        \\To see this, for any $\epsilon>0$, and for any $x\in[0,1]$, there exists an index $N_x\in\mathbb{N}$ such that for all $n\ge N_x$, we have $\frac{2}{n}<x$, that is, $x\in(\frac{2}{n},1]$, and so $|f_n(x)-f(x)|=0-0=0<\epsilon$.\\
        Therefore the sequence converges pointwise.\\
        To see that the sequence does not converge uniformly, we see that there exists an $\epsilon=1>0$ such that for all indices $N$, there exists an $n\ge N$ and the point $1/n$ such that $|f_n(1/n)-f(1/n)|=n-0=n>1$.
    \end{namedthm*}
    The pointwise limit of continuous functions may not be continuous.\\
    The pointwise limit of Riemann integrable functions may not be Riemann integrable.
    \begin{namedthm*}{Proposition 9}
        Let $\{f_n\}$ be a sequence of measurable functions on $E$ that converges pointwise a.e. on $E$ to the function $f$.
        Then $f$ is measurable.
    \end{namedthm*}
    \begin{proof}
        Let $E_0$ be a subset of $E$ such that $\{f_n\}$ converges pointwise to $f$ on $E\setminus E_0$, with $m(E_0)=0$. 
        Because $E_0$ has measure zero, then it is measurable; by Proposition 5, we have that $f$ is measurable iff the restrictions to $E_0$ and $E\setminus E_0$ are measurable.
        By monotonicity of measure, the measure of the set $\{x\in E_0\ |\ f(x)<c\}$ is always zero and thus trivially measurable.
        \\We want to show that $\{x\in E\setminus E_0\ |\ f(x)<c\}$ is measurable to use Proposition 5.
        \\Now, for any point $x\in E\setminus E_0$, we have that
        \[
            f(x)<c\iff\exists n,k\in\mathbb{N}\text{ s.t. }f_j(x)<c-1/n\ \forall j\ge k.    
        \]
        To see why, suppose that $\forall n,k\in\mathbb{N}, \exists j\ge k\text{ s.t. } f_j(x)\ge c-1/n$.
        \\In the case $f_j(x) > c-1/n$, we have $1/n+f_j(x)\ge c$ for all $n$, which implies that $f_j(x)\ge c>f$, a contradiction.
        \\In the case $f_j(x) = c-1/n$, we have that for any $n$, for any indices $k$, there exists an index $j\ge k$ such that $c-f_j(x)=1/n$, but because $f<c$, the convergence $\{f_n\}\to f$ is not possible, a contradiction.
        \\Then we can write 
        \[
            \{x\in E\setminus E_0\ |\ f(x)<c\}=\bigcup_{1\le n,k<\infty} \biggl[\bigcap_{j=k}^\infty\{x\in E\setminus E_0\ |\ f_j(x)<c-1/n\} \biggr],
        \]
        Which is a countable union and intersection of measurable sets, and thus is measurable.
    \end{proof}

    If $A$ is any set, the \textbf{characteristic function} of $A$, $\chi_A$, is the function on $\mathbb{R}$ defined by 
    \[
        \chi_A=
        \begin{cases}
            1&x\in A\\
            0&x\notin A
        \end{cases}  
    \]
    The function $\chi_A$ is measurable iff the set $A$ is measurable:\\
    $(\implies)$ Suppose $\chi_A$ is measurable.\\
    Then for the real number $c=0$, the set $\{x\in\mathbb{R}\ |\ \chi_A(x)>0\}=A$ is measurable.\\
    $(\impliedby)$ Suppose the set $A$ is measurable.\\
    Then for any real number $c$, we have
    \[
        \{x\in\mathbb{R}\ |\ \chi_A(x)\in(c,\infty)\}=
        \begin{cases}
            \emptyset&c\ge1\\
            A& 1>c\ge0\\
            \mathbb{R}&0>c\\
        \end{cases}
    \]
    Each of the sets $\emptyset$, $A$, and $\mathbb{R}$ are measurable, so $\{x\in\mathbb{R}\ |\ \chi_A(x)\in(c,\infty)\}$ is a measurable set and thus $\chi_A$ is a measurable function.\\
    Thus the existence of a nonmeasurable set $E$ implies the existence of a nonmeasurable function $\chi_E$.
        \begin{namedthm*}{Definition}
            A real-valued function $\varphi$ defined on a measurable set $E$ is called \textbf{simple} provided it is measurable and takes only a finite number of values.          
        \end{namedthm*}
        If $\varphi$ is simple, has domain $E$ and takes the distinct values $c_1,\cdots,c_n$, then
        \[
            \varphi=\sum_{k=1}^n c_k\cdot\chi_{E_k}\text{ on }E,\text{ where }E_k=\{x\in E\ |\ \varphi(x)=c_k\}.   
        \]
        (A linear combination of measurable functions)\\
        A simple function is called a \textbf{step function} in the special case that the sets $E_k$ are intervals. 
    \begin{namedthm*}{The Simple Approximation Lemma}
        Let $f$ be a measurable real-valued function on $E$. 
        Assume $f$ is bounded on $E$, that is, there is an $M\ge0$ for which $|f|\le M$ on $E$.
        Then for each $\epsilon>0$, there are simple functions $\varphi_\epsilon$ and $\psi_\epsilon$ defined on $E$ which have the following approximation properties:
        \[
            \varphi_\epsilon\le f\le\psi_\epsilon\text{ and }0\le\psi_\epsilon-\varphi_\epsilon<\epsilon\text{ on }E.    
        \]
    \end{namedthm*}
    \begin{proof}
        Because $f$ is bounded, we have that $f(x)\subseteq[-M,M]$ for all $x\in E$.
        \\Let $(c,d)$ be an open, bounded interval such that $f(E)\subseteq[-M,M]\subseteq(c,d)$, so that $(c,d)$ contains $f(E)$, the image of $E$ under $f$.
        \\Also, choose $\{y_0,\cdots,y_n\}$ to be a partition of the closed, bounded interval $[c,d]$ such that $y_k-y_{k-1}<\epsilon$ for $1\le k\le n$:
        \[
            c=y_0<y_1<\cdots<y_{n-1}<y_n=d
        \]
        Define 
        \[
            I_k=[y_{k-1},y_k)\text{ and }E_k=f^{-1}(I_k)\text{ for }1\le k \le n.
        \]
        Because $f$ is a measurable function and each interval $I_k=[y_{k-1},y_k)$ is Borel, then each set $E_k=f^{-1}(I_k)$ is measurable (see Problem 7).
        Because $E_k$ is measurable, then $\chi_{E_k}$ is a measurable function.
        \\Then we can define the simple functions $\varphi_\epsilon$ and $\psi_\epsilon$ on $E$ by
        \begin{align*}
            \varphi_\epsilon&=\sum_{k=1}^n y_{k-1}\cdot\chi_{E_k}\\
            \psi_\epsilon&=\sum_{k=1}^n y_k\cdot\chi_{E_k}
        \end{align*}
        Now, for any $x\in E$, because $f(E)\subseteq(c,d)$, and $\{[y_{k-1},y_k)\}_{k=1}^n$ is a partition that contains $(c,d)$, there exists a unique $k$, $1\le k\le n$, for which $f(x)\in[y_{k-1},y_k)$, and therefore
        \[
            \varphi_\epsilon(x)=y_{k-1}\le f(x)<y_k=\psi_\epsilon(x).    
        \]
        Also, for each $x\in E$, $\psi_\epsilon(x)-\varphi_\epsilon(x)=y_k-y_{k-1}<\epsilon$ for some $k$.
    \end{proof}
    \begin{namedthm*}{The Simple Approximation Theorem}
        An extended real-valued function $f$ on a measurable set $E$ is measurable iff there is a sequence $\{\varphi_n\}$ of simple functions on $E$ which converges pointwise on $E$ to $f$ and has the property that
        \[
            |\varphi_n|\le|f|\text{ on }E\text{ for all }n.
        \]
        If $f$ is nonnegative, we may choose $\{\varphi_n\}$ to be increasing.
    \end{namedthm*}
    \begin{proof}
        Let $f$ be an extended real-valued function on a measurable set $E$.\\
        $(\impliedby)$ Suppose $\{\varphi_n\}$ is a sequence of simple (and thus measurable) functions on $E$ that converges pointwise on $E$ to $f$ (and has the property that $|\varphi_n|\le|f|$ on $E$ for all $n$).\\
        Then by Proposition 9, $f$ is measurable.\\
        $(\implies)$ Suppose $f$ is measurable.\\
        We can assume $f\ge0$ on $E$ (See Problem 23 for the general case, as $f=f^+-f^-$ on $E$, a linear combination of two nonnegative measurable functions $f^+$ and $f^-$).
        \\For a natural number $n$, define $E_n=\{x\in E\ |\ f(x)\le n\}$. Because $f$ is a measurable function, the set $E_n\subseteq E$ is measurable.
        Then by Proposition 5 (ii), $f|_{E_n}$ is measurable.\\
        Also, $f|_{E_n}$ is bounded because $0\le f|_{E_n}(x)\le n$ for $x\in E_n$.\\
        Now, recall the Simple Approximation Lemma to see that for the measurable real-valued function $f|_{E_n}$ on $E_n$, where $f|_{E_n}$ is bounded on $E_n$, we have that for $\epsilon=1/n$, there exist simple functions $\varphi_n$ and $\psi_n$ defined on $E_n$ such that
        \[
            0\le\varphi_n\le f\le\psi_n\text{ on }E_n\text{ and }0\le\psi_n-\varphi_n<1/n\text{ on }E_n.    
        \]
        Then we can see that
        \[
            0\le\varphi_n\le f\text{ and }0\le f-\varphi_n\le\psi_n-\varphi_n<1/n\text{ on }E_n.    
        \]
        Now, $E=E_n\cup E_n^c= \{x\in E\ |\ f(x)\le n\}\cup\{x\in E\ |\ f(x)> n\}$ and $\varphi_n$ is defined on $E_n$. We can extend $\varphi_n$ to all of $E$ by setting $\varphi_n(x)=n$ on $E_n^c=\{x\in E\ |\ f(x)> n\}$.
        Then $\varphi_n$ is a simple function defined on $E$ and $0\le \varphi_n\le f$ on $E$.
        To see that $\{\varphi_n\}$ converges to $f$ pointwise on $E$:\\
        Consider any $x\in E$.\\
        Case $f(x)<\infty$:\\
        Then there exists a natural number $N$ such that $f(x)\le N$.
        Then for all $n\ge N$, We have that
        \[
            0\le f(x)-\varphi_n(x)<1/n,    
        \]
        and thus $\lim_{n\to\infty}\varphi_n(x)=f(x)$.\\
        Case $f(x)=\infty$:\\
        Then $\varphi_n(x)=n$ because $f(x)> n$ for all $n$, and $\lim_{n\to\infty}\varphi_n(x)=\infty=f(x)$.\\
        By replacing each $\varphi_n$ with $\max\{\varphi_1,\cdots,\varphi_n\}$, we have $\{\varphi_n\}$ increasing.
    \end{proof}
\end{flushleft}
\begin{center}
	\textbf{PROBLEMS}
\end{center}
\begin{enumerate}
	\setcounter{enumi}{11}
    \item Let $f$ be a bounded measurable function on $E$. Show that there are sequences of simple functions on $E$, $\{\varphi_n\}$ and $\{\psi_n\}$, such that $\{\varphi_n\}$ is increasing and $\{\psi_n\}$ is decreasing and each of these sequences converges to $f$ uniformly on $E$.\\
    \\Let $f$ be a bounded measurable function on the measurable set $E$.
    Because $f$ is bounded, there exists a real number $M$ such that $|f|\le M$ and thus $-M\le f\le M$.
    Then for all natural numbers $n\ge M$, the set $E_n=\{x\in E\ |\ f(x)\le n\}=E$.
    By the Simple Approximation Lemma, for $\epsilon=1/n$, there exist the simple function $\varphi_n$ and $\psi_n$ defined on $E_n=E$ such that 
    \[
            \varphi_n\le f\le\psi_n\text{ and }0\le\psi_n-\varphi_n<1/n\text{ on }E.    
    \]
    Then for each $n\ge M$, we have the sequences of functions $\{\varphi_n\}$ and $\{\psi_n\}$ such that
    \begin{align*}
        \varphi_n\le f&\text{ and }f-\varphi_n\le\psi_n-\varphi_n<1/n\text{ on }E,\\  
        f\le\psi_n&\text{ and }\psi_n-f\le\psi_n-\varphi_n<1/n\text{ on }E.    
    \end{align*}
    We can replace each $\varphi_n$ with $\max\{\varphi_1,\cdots,\varphi_n\}$ and each $\psi_n$ with $\min\{\psi_1,\cdots,\psi_n\}$ so that the sequences are increasing and decreasing respectively.
    The convergence is uniform because we showed that for any $\epsilon=1/n$, there exists the natural number $n$ such that for all $n'\ge n$, $f(x)-\varphi_{n'}(x)<1/n$ and $\psi_{n'}(x)-f(x)<1/n$ for all $x\in E$.
    \item A real-valued measurable function is said to be \textit{semisimple} provided it takes only a countable number of values. Let $f$ be any measurable function on $E$.
    Show that there is a sequence of semisimple functions $\{f_n\}$ on $E$ that converges to $f$ uniformly on $E$.\\
    \\We can define $f_n(x)=\frac{1}{n}\lfloor nf(x)\rfloor$ (where the floor function $\lfloor x\rfloor$ returns the largest integer less than or equal to $x$).
    Then because $f_n=\frac{\lfloor nf(x)\rfloor}{n}$ and $\lfloor nf(x)\rfloor$ and $n$ are integers, we have $f_n(E)\subseteq\mathbb{Q}$ which is countable.
    Because the floor function rounds down to the nearest integer, we have
    \[
        |nf(x)-\lfloor nf(x)\rfloor|<1\text{ for all }x\in E,
    \]
    and therefore
    \[
        |f(x)-\frac{1}{n}\lfloor nf(x)\rfloor|<1/n\text{ for all }x\in E.
    \]
    \item Let $f$ be a measurable function on $E$ that is finite a.e. on $E$ and $m(E)<\infty$.
    For each $\epsilon>0$, show that there is a measurable set $F$ contained in $E$ such that $f$ is bounded on $F$ and $m(E\setminus F)<\epsilon$.\\
    \\For each natural number $n$, let $F_n=\{x\in E\ |\ f(x)>n\}$. 
    Because $f$ is measurable, then each $F_n$ is a measurable set. 
    Then $\{F_n\}$ is descending because 
    \[
        F_n=\{x\in E\ |\ f(x)>n\}\supseteq\{x\in E\ |\ f(x)>n+1>n\}=F_{n+1}.
    \]
    Also, $F_1\subseteq E$, so by monotonicity of measure, $m(F_1)\le m(E)<\infty$.
    \\By the continuity of measure, for the descending collection of measurable sets $\{F_n\}$ for which $m(F_1)<\infty$, we have $m(\bigcap_{n=1}^\infty F_n)=\lim_{n\to\infty}m(F_n)$.
    \\Now, 
    \[
        \bigcap_{n=1}^\infty F_n = \bigcap_{n=1}^\infty\{x\in E\ |\ f(x)>n\}=\{x\in E\ |\ f(x)=\infty\},
    \]
    Because $f$ is finite a.e. on $E$, we have 
    \[
        0=m(\{x\in E\ |\ f(x)=\infty\})=m(\bigcap_{n=1}^\infty F_n)=\lim_{n\to\infty}m(F_n).
    \]
    Then for any $\epsilon>0$, there exists an $N\in\mathbb{N}$ such that for all $n\ge N$, we have $m(F_n)<\epsilon$.
    \\If we let $F=E\cap F_n^c=E\setminus F_n \subseteq E$, then $F=\{x\in E\ |\ f(x)\le n\}$, a measurable set, and 
    \[
        E\cap F^c=E\cap [E^c\cup F_n]=[E\cap E^c]\cup[E\cap F_n]=\emptyset\cup F_n=F_n,
    \]
    and thus we have
    \[
        m(E\setminus F)=m(E\cap F^c)=m(F_n)<\epsilon.
    \]
    \item Let $f$ be a measurable function on $E$ that if finite a.e. on $E$ and $m(E)<\infty$. 
    Show that for each $\epsilon>0$, there is a measurable set $F$ contained in $E$ and a sequence $\{\varphi_n\}$ of simple functions on $E$ such that $\{\varphi_n\}\to f$ uniformly on $F$ and $m(E\setminus F)<\epsilon$. (Hint: see the preceding problem.)\\
    \\Because $f$ is finite a.e. on $E$ and $m(E)<\infty$, by the previous problem, for any $\epsilon>0$, there exists a measurable set $F\subseteq E$ such that $f$ is bounded on $F$ and $m(E \setminus F)<\epsilon$.
    Furthermore, because $f$ is bounded and measurable on $F$, by Problem 12, there exists a sequence of simple functions $\{\varphi_n\}$ on $F$ that converges uniformly to $f$ on $F$.
    Each $\varphi_n$ can be extended to $E$ by setting $\varphi_n=n$ on $F^c$.
    \item Let $I$ be a closed, bounded interval and $E$ a measurable subset of $I$. Let $\epsilon>0$.
    Show that there is a step function $h$ on $I$ and a measurable subset $F$ of $I$ for which 
    \[
        h=\chi_E\text{ on }F\text{ and }m(I\setminus F)<\epsilon.    
    \]
    (Hint: use Theorem 12 of Chapter 2.)\\
    \\Theorem 12 of Chapter 2 states:
    \\Let $E$ be a measurable set of finite outer measure.
    Then for each $\epsilon>0$, there is a finite disjoint collection of open intervals $\{I_k\}_{k=1}^n$ for which if $\mathcal{O}=\bigcup_{k=1}^n I_k$, then
    \[
        m^*(E\setminus\mathcal{O})+m^*(\mathcal{O}\setminus E)<\epsilon.    
    \]
    $\cdots$\\
    Fix $\epsilon>0$.\\
    Because $m(E)$ is finite, by definition of infimum, for $\epsilon>0$, there exists a countable collection of open intervals $\{I_k\}_{k=1}^\infty$ whose union $\mathcal{O}=\bigcup_{k=1}^\infty I_k$ covers $E$ and 
    \[
        m(E)\le \sum_{k=1}^\infty \ell(I_k)< m(E)+\epsilon/2,
    \]
    and $\sum_{k=1}^\infty\ell(I_k)$ is finite as well.
    Because $E$ is a measurable subset of finite outer measure that is contained in $\mathcal{O}$, then we can use the excision property and subadditivity to see that
    \begin{equation}
        m(\mathcal{O}\setminus E)=m(\mathcal{O})-m(E)=m(\bigcup_{k=1}^\infty I_k)-m(E)\le\sum_{k=1}^\infty \ell(I_k)-m(E)< \epsilon/2,\tag{1}
    \end{equation}
    Because the series $\sum_{k=1}^\infty\ell(I_k)$ is finite, the sequence of partial sums $\sum_{k=1}^n\ell(I_k)$ converges to $\sum_{k=1}^\infty\ell(I_k)$, so that for $\epsilon/2$, there exists an index $N$ such that for all $n\ge N$, we have
    \begin{align*}
        \sum_{k=1}^\infty\ell(I_k)-\sum_{k=1}^n\ell(I_k) &<\epsilon/2\\
        \sum_{k=n+1}^\infty\ell(I_k)+\sum_{k=1}^n\ell(I_k)-\sum_{k=1}^n\ell(I_k) &<\epsilon/2\\
        \sum_{k=n+1}^\infty\ell(I_k)&<\epsilon/2,
    \end{align*}
    and then we can let $\mathcal{O}'=\bigcup_{k=1}^N I_k$ so that, because $E\cap(\mathcal{O}\setminus\mathcal{O}')\subseteq\mathcal{O}\setminus\mathcal{O}'$,
    \[
        m(E\cap(\mathcal{O}\setminus\mathcal{O}'))\le m(\mathcal{O}\setminus\mathcal{O}')=m(\bigcup_{k=1}^\infty I_k\setminus\bigcup_{k=1}^N I_k)=m(\bigcup_{k=N+1}^\infty I_k)\le\sum_{k=N+1}^\infty\ell(I_k)<\epsilon/2.
    \]
    Because $E\subseteq \mathcal{O}$, then $E\cap \mathcal{O}^c=\emptyset$, and we can derive
    \begin{align*}
        E\cap\mathcal{O}'&=[\emptyset\cup(E\cap\mathcal{O}')]\\
        &=[(E\cap\mathcal{O}^c)\cup(E\cap\mathcal{O}')]\\
        &=\emptyset\cup[(E\cap\mathcal{O}^c)\cup(E\cap\mathcal{O}')]\\
        &=[E\cap E^c]\cup[E\cap(\mathcal{O}^c\cup\mathcal{O}')]\\
        &=E\cap[E^c\cup(\mathcal{O}^c\cup\mathcal{O}')]\\
        &=E\cap[E^c\cup(\mathcal{O}\cap\mathcal{O}'^c)^c]\\
        &=E\cap[E\cap(\mathcal{O}\setminus\mathcal{O}')]^c\\
        &=E\setminus[E\cap(\mathcal{O}\setminus\mathcal{O}')].
    \end{align*}
    And then we see that by excision,
    \begin{equation}
        m(E\cap\mathcal{O}')=m(E\setminus[E\cap(\mathcal{O}\setminus\mathcal{O}')])=m(E)-m(E\cap(\mathcal{O}\setminus\mathcal{O}'))>m(E)-\epsilon/2.\tag{2}
    \end{equation}
    We will let $F=(E\cap\mathcal{O}')\cup(I\setminus\mathcal{O})$ so that 
    \begin{align*}
        I\setminus F&=I\cap F^c\\
        &=I\cap[(E\cap\mathcal{O}')\cup(I\setminus\mathcal{O})]^c\\
        &=I\cap[(I^c\cup\mathcal{O})\cap(E\cap\mathcal{O}')^c]\\
        &=[I\cap(I^c\cup\mathcal{O})]\cap(E\cap\mathcal{O}')^c\\
        &=[(I\cap I^c)\cup(I\cap\mathcal{O})]\cap(E\cap\mathcal{O}')^c\\
        &=[I\cap\mathcal{O}]\setminus(E\cap\mathcal{O}')\\
        &\subseteq\mathcal{O}\setminus[E\cap\mathcal{O}'].
    \end{align*}
    Therefore we can write
    \begin{align*}
        m(I\setminus F)&\le m(\mathcal{O}\setminus[E\cap\mathcal{O}'])&&\text{by monotonicity}\\
        &=m(\mathcal{O})-m(E\cap\mathcal{O}')&&\text{by excision}\\
        &<m(\mathcal{O})-m(E)+\epsilon/2&&\text{by (2)}\\
        &<\epsilon/2+\epsilon/2&&\text{by (1)}\\\
        &<\epsilon.
    \end{align*}
    We can let $h=\sum_{k=1}^n \chi_{J_k}=\chi_{\mathcal{O}'}$, with $J_k=I_k\setminus\bigcup_{j=1}^{k-1}I_j$, where each $J_k$ is a finite union of disjoint intervals, and so $h$ is a step function.
    Then $h=1$ on $E\cap\mathcal{O}'$ and $h=0$ on $I\setminus\mathcal{O}$, so that $h=\chi_E$ on $F$.
    \item Let $I$ be a closed, bounded interval and $\psi$ a simple function defined on $I$. Let $\epsilon>0$.
    Show that there is a step function $h$ on $I$ and a measurable subset $F$ of $I$ for which 
    \[
        h=\psi\text{ on }F\text{ and }m(I\setminus F)<\epsilon.    
    \] 
    (Hint: use the fact that a simple function is a linear combination of characteristic functions and the preceding problem.)\\
    \\We have
    \[
        \psi=\sum_{k=1}^n c_k\cdot\chi_{E_k}\text{ on }I,\text{ where }E_k=\{x\in I\ |\ \psi(x)=c_k\}\text{ measurable}.  
    \]
    For each $k=1,\cdots,n$, we have that $I$ is a closed, bounded interval and $E_k$ a measurable subset of $I$.
    For $\epsilon>0$, by the previous Problem 16, there is a step function $h_k$ on $I$ and a measurable subset $F_k$ of $I$ for which 
    \[
        h_k=\chi_{E_k}\text{ on }F_k\text{ and }m(I\setminus F_k)<\epsilon/n.    
    \]
    We can let $h=\sum_{k=1}^n c_k h_k$ and $F=\bigcap_{k=1}^n F_k$ so that $h=\psi$ on $F$ and $I\cap F^c=I\cap \bigcup_{k=1}^n F_k^c=\bigcup_{k=1}^n (I\cap F_k^c)$ which gives us
    \[
        m(I\setminus F)=m(I\cap F^c)=m(\bigcup_{k=1}^n (I\cap F_k^c))\le \sum_{k=1}^n m(I\cap F_k^c)=\sum_{k=1}^n m(I\setminus F_k)<\epsilon.
    \]
    \item Let $I$ be a closed, bounded interval and $f$ a bounded measurable function defined on $I$. Let $\epsilon>0$.
    Show that there is a step function $h$ on $I$ and a measurable subset $F$ of $I$ for which 
    \[
        |h-f|<\epsilon\text{ on }F\text{ and }m(I\setminus F)<\epsilon.    
    \]
    Because $f$ is bounded and measurable on $I$, by Problem 12, there exists a sequence of simple functions $\{\psi_n\}$ on $I$ that converges uniformly to $f$ on $I$.
    Then for any $\epsilon$, we can choose $\psi\in\{\psi_n\}$ such that $|\psi-f|<\epsilon$.
    By the previous Problem 17, there is a step function $h$ on $I$ and a measurable subset $F$ of $I$ for which 
    \[
        h=\psi\text{ on }F\text{ and }m(I\setminus F)<\epsilon.    
    \] 
    Therefore we have $|h-f|<\epsilon$.
    \item Show that the sum and product of two simple functions are simple as are the max and the min.\\
    \\Consider two simple functions $\varphi$ and $\psi$ on the measurable set $E$, with
    \[
        \varphi=\sum_{k=1}^n c_k\cdot\chi_{E_k}\text{ on }E,\text{ where }E_k=\{x\in E\ |\ \varphi(x)=c_k\}\text{ measurable}.  
    \]
    \[
        \psi=\sum_{k'=1}^m c'_{k'}\cdot\chi_{E'_{k'}}\text{ on }E,\text{ where }E'_{k'}=\{x\in E\ |\ \psi(x)=c'_{k'}\}\text{ measurable}.  
    \]
    Then for any $x\in E$, there exists an $i\in \{1,\cdots,n\}$ and $j\in \{1,\cdots,m\}$ such that
    \[
        (\varphi+\psi)(x)= c_i+c'_j\text{ on }E_i\cap E'_j,
    \]
    The intersection of measurable sets $E_i\cap E'_j$ is also measurable, so the function $\chi_{E_i\cap E'_j}$ is measurable.\\ 
    That is, we have the simple function
    \[
        \varphi+\psi=\sum_{k=1}^n \sum_{k'=1}^m (c_k+c_{k'})\cdot\chi_{E_k\cap E'_{k'}}\text{ on }E.
    \]
    Similarly for the product, we have
    \[
        \varphi\cdot\psi=\sum_{k=1}^n \sum_{k'=1}^m (c_k\cdot c_{k'})\cdot\chi_{E_k\cap E'_{k'}}\text{ on }E.
    \]
    We can recall Chapter 1 Problem 49 to see how we define max and min:
    \begin{align*}
        \max\{\varphi,\psi\}&=\frac{1}{2}(\varphi+\psi+|\varphi-\psi|),\\
        \min\{\varphi,\psi\}&=\frac{1}{2}(\varphi+\psi-|\varphi-\psi|).
    \end{align*}
    Clearly scaling a simple function is simple, and the absolute value of a simple function is simple, and we showed that the sum of simple functions is simple, and therefore the max and min of simple functions is simple.
    \item Let $A,B$ be any sets. Show that
    \begin{align*}
        \chi_{A\cap B}&=\chi_A\cdot\chi_B\\
        \chi_{A\cup B}&=\chi_A+\chi_B-\chi_A\cdot\chi_B\\
        \chi_{A^c}&=1-\chi_A
    \end{align*}
    \\We can use DeMorgan's laws to see that
    \[
        \chi_{A\cap B}=
        \begin{cases}
            1&x\in A\cap B\\
            0&x\notin A\cap B
        \end{cases}  
        =
        \begin{cases}
            1&x\in A\cap B\\
            0&x\in A^c\cup B^c
        \end{cases}
        =
        \begin{cases}
            1&x\in A \text{ and }x\in B\\
            0&x\notin A\text{ or }x\notin B
        \end{cases} 
    \]
    Then for any $x\in\mathbb{R}$, we have
    \begin{center}
        \begin{tabular}{|c c c c|} 
        \hline
        $\chi_A(x)$  & $\chi_B(x)$ & $\chi_{A\cap B}(x)$ & $\chi_A(x)\cdot\chi_B(x)$ \\ [0.5ex] 
        \hline\hline
        0 & 0 & 0 & $0\cdot0=0$  \\ 
        \hline
        0 & 1 & 0 & $0\cdot1=0$   \\
        \hline
        1 & 0 & 0 & $1\cdot0=0$   \\
        \hline
        1 & 1 & 1 & $1\cdot1=1$ \\[1ex] 
        \hline
        \end{tabular}
    \end{center}
    Similarly see that
    \[
        \chi_{A\cup B}=
        \begin{cases}
            1&x\in A\cup B\\
            0&x\notin A\cup B
        \end{cases}  
        =
        \begin{cases}
            1&x\in A\cup B\\
            0&x\in A^c\cap B^c
        \end{cases}
        =
        \begin{cases}
            1&x\in A \text{ or }x\in B\\
            0&x\notin A\text{ and }x\notin B
        \end{cases} 
    \]
    Then for any $x\in\mathbb{R}$, we have
    \begin{center}
        \begin{tabular}{|c c c c|} 
        \hline
        $\chi_A(x)$  & $\chi_B(x)$ & $\chi_{A\cup B}(x)$ & $\chi_A(x)+\chi_B(x)-\chi_A(x)\cdot\chi_B(x)$ \\ [0.5ex] 
        \hline\hline
        0 & 0 & 0 & $0+0-0\cdot0=0$   \\ 
        \hline
        0 & 1 & 1 & $0+1-0\cdot1=1$ \\
        \hline
        1 & 0 & 1 & $1+0-1\cdot0=1$  \\
        \hline
        1 & 1 & 1 & $1+1-1\cdot1=1$ \\[1ex] 
        \hline
        \end{tabular}
    \end{center}
    Finally see that
    \[
        \chi_{A^c}=
        \begin{cases}
            1&x\in A^c\\
            0&x\notin A^c
        \end{cases}  
        =
        \begin{cases}
            1&x\notin A\\
            0&x\in A
        \end{cases} 
        =
        \begin{cases}
            1-0&x\notin A\\
            1-1&x\in A
        \end{cases} 
        =
        1-
        \begin{cases}
            0&x\notin A\\
            1&x\in A
        \end{cases} 
        =
        1-\chi_A.
    \]
    That is, for any $x\in\mathbb{R}$, we have
    \begin{center}
        \begin{tabular}{|c c c|} 
        \hline
        $\chi_{A}(x)$ & $\chi_{A^c}(x)$ & 1-$\chi_{A}(x)$ \\ [0.5ex] 
        \hline\hline
        1 & 0 & $1-1=0$  \\ 
        \hline
        0 & 1 & $1-0=1$ \\[1ex] 
        \hline
        \end{tabular}
    \end{center}
    \item For a sequence $\{f_n\}$ of measurable functions with common domain $E$, show that each of the following functions is measurable:
    \begin{itemize}
        \item $\inf\{f_n\}$\\
        \\We have 
        \[
            \inf\{f_n\} = \{x\in E\ |\ \inf\{f_n\}> c\} = \bigcap_{n=1}^\infty\{x\in E\ |\ f_n(x)>c\}
        \]
        or
        \[
            \inf\{f_n\} = \{x\in E\ |\ \inf\{f_n\}< c\} = \bigcup_{n=1}^\infty\{x\in E\ |\ f_n(x)<c\}
        \]
        \item $\sup\{f_n\}$\\
        \\Similarly,
        \[
            \sup\{f_n\} = \{x\in E\ |\ \sup\{f_n\}> c\} = \bigcup_{n=1}^\infty\{x\in E\ |\ f_n(x)>c\}
        \]
        or
        \[
            \sup\{f_n\} = \{x\in E\ |\ \sup\{f_n\}< c\} = \bigcap_{n=1}^\infty\{x\in E\ |\ f_n(x)<c\}
        \]
        \item $\lim\inf\{f_n\}$
        \item $\lim\sup\{f_n\}$
    \end{itemize}
    \item (Dini's Theorem) Let $\{f_n\}$ be an increasing sequence of continuous functions on $[a,b]$ which converges pointwise on $[a,b]$ to the continuous function $f$ on $[a,b]$.
    Show that the convergence is uniform on $[a,b]$. (Hint: let $\epsilon>0$. For each natural number $n$, define $E_n=\{x\in[a,b]\ |\ f(x)-f_n(x)<\epsilon\}$. Show that $\{E_n\}$ is an open cover of $[a,b]$ and use the Heine-Borel Theorem.)\\
    \\Let $\epsilon>0$. For each natural number $n$, define 
    \begin{align*}
        E_n&=\{x\in[a,b]\ |\ f(x)-f_n(x)<\epsilon\}\\
        &=\{x\in[a,b]\ |\ f(x)-f_n(x)\in(-\infty,\epsilon)\}\\
        &=(f-f_n)^{-1}((-\infty,\epsilon)).
    \end{align*}
    The sum and product of continuous functions is continuous, so the function $f-f_n$ is continuous and therefore $E_n=(f-f_n)^{-1}((-\infty,\epsilon))$ is an open set.
    \\Because $\{f_n\}$ converges pointwise to $f$ on $[a,b]$, for any $\epsilon>0$, for any $x\in[a,b]$, there exists an index $N_x\in\mathbb{N}$ such that for all $n\ge N_x$, we have $|f(x)-f_n(x)|<\epsilon$.
    \\This means that for any $x\in[a,b]$, there exists an index $N_x\in\mathbb{N}$ such that $x\in\{x\in[a,b]\ |\ f(x)-f_{N_x}(x)<\epsilon\}=E_{N_x}$, and so $x\in\bigcup_{n\in\mathbb{N}} E_n$, which implies
    \[
        \forall x\in[a,b],\exists N_x\in\mathbb{N}\text{ s.t. }x\in\{x\in[a,b]\ |\ |f(x)-f_{N_x}(x)|<\epsilon\}=E_{N_x}\implies x\in\bigcup_{n\in\mathbb{N}} E_n,
    \]
    and by definition of subset, $[a,b]\subseteq \bigcup_{n\in\mathbb{N}} E_n$.
    Now, $\{E_n\}$ is an open cover of $[a,b]$ because it is a union of open sets $E_n$ and it covers $[a,b]$.
    Because $[a,b]$ is compact, there exists a finite subcover $\{E_{n_k}\}_{k=1}^m\subseteq\{E_n\}$. 
    \\This means that for any $x\in[a,b]$, there exists the index $k\in\{1,\cdots,m\}$ such that $x\in E_{n_k}=\{x\in[a,b]\ |\ |f(x)-f_{n_k}(x)|<\epsilon\}$.
    \\Then we can let $N_0=\max\{n_1,\cdots,n_m\}$.
    \\Therefore for any $\epsilon>0$, there exists the index $N_0$ such that for all $n\ge N_0\ge n_i$, $i\in\{1,\cdots,m\}$,
    \[
        |f(x)-f_n(x)|<\epsilon\text{ for all }x\in[a,b].
    \]
    Thus we have uniform convergence.
    \item Express a measurable function as the difference of nonnegative measurable functions and thereby prove the general Simple Approximation Theorem based on the special case of a nonnegative measurable function.\\
    \\Let $f$ be a measurable function on $E$, and we have $f=f^+-f^-$ on $E$, a linear combination of the two nonnegative measurable functions $f^+=\max\{f,0\}\ge0$ and $f^-=\max\{-f,0\}\ge0$.
    In our proof for the Simple Approximation Theorem, we proved the case for $f^+\ge0$ and $f^-\ge0$ that there exist sequences $\{\varphi^+_n\}$ and $\{\varphi^-_n\}$ of simple functions on $E$ that converge pointwise on $E$ to $f^+$ and $f^-$ respectively, and 
    \begin{align*}
        0\le\varphi^+_n&\le f^+\text{ on }E\text{ for all }n,\\
        0\le\varphi^-_n&\le f^-\text{ on }E\text{ for all }n.
    \end{align*}
    then
    \begin{align*}
        0\ge-\varphi^-_n&\ge -f^-\text{ on }E\text{ for all }n,
    \end{align*}
    so that $-f^-\le-\varphi^-_n\le f^-\implies -\varphi^-_n \le |f^-|$.
    \\We have the sets $E^+=\{x\in E\ |\ f(x)\ge0\}$ and $E^-=\{x\in E\ |\ f(x)\le0\}$, so that
    \[
        f(x)=|f(x)|=
        \begin{cases}
            0&\text{ if }x\in E^+\cap E^-\\
            f^+(x)&\text{ if }x\in E^+\text{ only}\\
            f^-(x)&\text{ if }x\in E^-\text{ only}
        \end{cases}    
    \]
    The function $\varphi^+_n-\varphi^-_n$ is simple and
    \[
        0\le\varphi^+_n\le f^+=0, 0\le\varphi^-_n\le f^-=0\text{ on }E^+\cap E^-\implies\varphi^+_n,\varphi^-_n =0,
    \]
    and so we have
    \[
        (\varphi^+_n-\varphi^-_n)(x)=
        \begin{cases}
            0\le f(x)&\text{ if }x\in E^+\cap E^-\\
            \varphi^+_n(x)\le f^+(x)&\text{ if }x\in E^+\text{ only}\\
            -\varphi^-_n(x)\le f^-(x)&\text{ if }x\in E^-\text{ only}
        \end{cases}    
    \]
    Then clearly $\varphi^+_n-\varphi^-_n$ converges pointwise to $f$ on $E$, and therefore we have
    \begin{align*}
        |\varphi^+_n-\varphi^-_n|&\le|f|\text{ on }E\text{ for all }n.
    \end{align*}
    \item Let $I$ be an interval and $f:I\to\mathbb{R}$ be increasing. Show that $f$ is measurable by first showing that, for each natural number $n$, the strictly increasing function $x\mapsto f(x)+x/n$ is measurable, and then taking pointwise limits.\\
    \\Let $f_n(x)=f(x)+x/n$.\\
    Then each $f_n$ is strictly increasing; that is, for $x,y\in I$, we have $f_n(x)<f_n(y)\iff x<y$. 
    This also tells us that each $f_n$ is injective because 
    \[
        x\neq y \implies x<y\text{ or }y<x \implies f_n(x)<f_n(y)\text{ or }f_n(y)<f_n(x)\implies f_n(x)\neq f_n(y).
    \]
    So for any element $x^*\in dom(f_n)$, we know that $f_n^{-1}(x^*)$ consists of a single element at most.
    \\Now, for any two $x^*,y^*\in(a,\infty)$, by definition of interval, any point $z^*$ between them is also in $(a,\infty)$. 
    \\We then have $x^*<z^*<y^* \iff f_n^{-1}(x^*)<f_n^{-1}(z^*)<f_n^{-1}(y^*)$, and so the set $f_n^{-1}((a,\infty))=\{x\in I\ |\ f_n(x)\in(a,\infty)\}$ is an interval for all $a$, and every interval is measurable, so $f_n$ is measurable.
    \\To see that $\{f_n\}$ converges pointwise to $f$, let $\epsilon>0$ and consider $x\in I$. 
    Then there exists an index $N$ such that for all $n\ge N$, 
    \[
        |f_n(x)-f(x)|=|x/n|<\epsilon.    
    \]
    Now, because $\{f_n\}$ is a sequence of measurable functions in $I$ that converges pointwise a.e. on $I$ to $f$, then by Proposition 9, $f$ is measurable.
\end{enumerate}

% 3.3
\section{Littlewood's Three Principles, Ergoff's Theorem, and Lusin's Theorem}
\begin{flushleft}
    \begin{namedthm*}{Egoroff's Theorem}
        Assume $E$ has finite measure. Let $\{f_n\}$ be a sequence of measurable functions on $E$ that converges pointwise on $E$ to the real-valued function $f$.
        Then for each $\epsilon>0$, there is a closed set $F$ contained in $E$ for which     
        \[
            \{f_n\}\to f\text{ uniformly on }F\text{ and }m(E\setminus F)<\epsilon.    
        \]
    \end{namedthm*}
    \begin{namedthm*}{Lemma 10}
        Under the assumptions of Egoroff's Theorem, for each $\eta>0$ and $\delta>0$, there is a measurable subset $A$ of $E$ and an index $N$ for which
        \[
            |f_n-f|<\eta\text{ on }A\text{ for all }n\ge N\text{ and }m(E\setminus A)<\delta.    
        \]
    \end{namedthm*}
    \begin{proof}
        First, we can see that because $\{f_n\}$ is a sequence of measurable functions on $E$ that converges pointwise on $E$ to $f$, by Proposition 9, $f$ is measurable.
        Then by Theorem 6, the function $f_n-f$ is measurable.
        Finally by Proposition 7, considering the continuous function $|\cdot|$ and the measurable function $f_n-f$, the composition $|f_n-f|$ is measurable.
        \\This means that the set $\{x\in E\ |\ |f_n-f|<\eta\}$ is measurable.
        \\Then we see that
        \[
            E_n=\{x\in E\ |\ |f_k-f|<\eta\text{ for all }k\ge n\}=\bigcap_{k=n}^\infty\{x\in E\ |\ |f_k-f|<\eta\},
        \]
        is also measurable.
        \\Then $\{E_n\}$ is an ascending sequence of measurable sets because 
        \[
            E_n=\{x\in E\ |\ |f_n-f|<\eta\}\cap\biggl[\bigcap_{k={n+1}}^\infty\{x\in E\ |\ |f_k-f|<\eta\}\biggr]\subseteq \bigcap_{k={n+1}}^\infty\{x\in E\ |\ |f_k-f|<\eta\}=E_{n+1}.
        \]
        Also, $E=\bigcup_{n=1}^\infty E_n$, because $\{f_n\}$ converges pointwise to $f$ on $E$. 
        \\That is, for $\eta>0$, for $x\in E$, there exists an index $N\in\mathbb{N}$ such that
        \[
            |f_k(x)-f(x)|<\eta\text{ for all }k\ge N,
        \]
        and thus $x\in E_N$.
        \\Now, by continuity of measure, we have
        \[
            m(E)=m(\bigcup_{n=1}^\infty E_n)=\lim_{n\to\infty}m(E_n).
        \]
        Then because $m(E)<\infty$, there exists an index $N_0$ for which $m(E)-m(E_{N_0})<\delta$.
        \\Define $A=E_{N_0}$ so we can use excision to see that
        \[
            m(E\setminus A)=m(E)-m(E_{N_0})<\delta,
        \]
        and 
        \[
            A=\{x\in E\ |\ |f_k-f|<\eta\text{ for all }k\ge N_0\}.
        \]
    \end{proof}
    \begin{proof}
        To prove Egoroff's Theorem:\\
        Assume $E$ has finite measure. Let $\{f_n\}$ be a sequence of measurable functions on $E$ that converges pointwise on $E$ to the real-valued function $f$.
        \\For each natural number $n$, we can let $\eta=1/n$ and $\delta=\epsilon/2^{n+1}$.
        \\By Lemma 10, there exists a subset $A_n$ of $E$ and an index $N_n$ for which
        \[
            |f_k-f|<1/n\text{ on }A_n\text{ for all }k\ge N_n\text{ and }m(E\setminus A_n)<\epsilon/2^{n+1}.    
        \]
        We define 
        \[
            A=\bigcap_{n=1}^\infty A_n.
        \]
        Then we see that
        \begin{align*}
            m(E\setminus A)&=m(E\setminus \biggl[\bigcap_{n=1}^\infty A_n\biggr])\\
            &=m(E\cap \biggl[\bigcup_{n=1}^\infty A_n^c\biggr])\\
            &=m(\bigcup_{n=1}^\infty [E\cap A_n^c])\\
            &\le \sum_{n=1}^\infty m(E\cap A_n^c)\\
            &< \sum_{n=1}^\infty \epsilon/2^{n+1}\\
            &= \frac{1}{2} \sum_{n=1}^\infty \epsilon/2^n\\
            &=\epsilon/2.
        \end{align*}
        To see that $\{f_n\}$ converges uniformly to $f$ on $A$:
        \\Let $\epsilon>0$. Then there exists an index $n_0$ such that $1/n_0<\epsilon$ and 
        \[
            |f_k-f|<1/n_0<\epsilon\text{ on }A\subseteq A_{n_0}\text{ for all }k\ge N_{n_0}.
        \]
        Finally we can use Chapter 2 Theorem 11 to choose a closed set $F$ contained in $A$ for which $m(A\setminus F)<\epsilon/2$.
        Then we have
        \begin{align*}
            m(E\setminus F)&=m(E)-m(F)&&\text{by excision}\\
            &= m(E)-m(A)+m(A)-m(F)\\
            &=m(E\setminus A)+m(A\setminus F)&&\text{by excision}\\
            &<\epsilon/2+\epsilon/2\\
            &=\epsilon.
        \end{align*}
        Therefore $\{f_n\}\to f$ uniformly on $F$ and $m(E\setminus F)<\epsilon$.
    \end{proof}
    \begin{namedthm*}{Proposition 11}
        Let $f$ be a simple function defined on $E$.
        Then for each $\epsilon>0$, there is a continuous function $g$ on $\mathbb{R}$ and a closed set $F$ contained in $E$ for which
        \[
            f=g\text{ on }F\text{ and }m(E\setminus F)<\epsilon.    
        \]
    \end{namedthm*}
    \begin{namedthm*}{Lusin's Theorem}
        Let $f$ be a real-valued measurable function on $E$.
        Then for each $\epsilon>0$, there is a continuous function $g$ on $\mathbb{R}$ and a closed set $F$ contained in $E$ for which 
        \[
            f=g\text{ on }F\text{ and }m(E\setminus F)<\epsilon.
        \]
    \end{namedthm*}
    \begin{proof}
        Consider the case that $m(E)<\infty$.
        \\The Simple Approximation Theorem tells us that there exists a sequence of simple functions $\{f_n\}$ defined on $E$ that converges to $f$ pointwise on $E$.
        \\By the previous Proposition 11, for each $n$, there exists a continuous function $g_n$ on $\mathbb{R}$ and a closed set $F_n$ contained in $E$ for which
        \[
            f_n=g_n\text{ on }F_n\text{ and }m(E\setminus F_n)<\epsilon/2^{n+1}.    
        \]
        Also, Egoroff's Theorem states that because $E$ has finite measure and that $\{f_n\}$ is a sequence of simple (measurable) function on $E$ that converges pointwise on $E$ to the real-valued function $f$, we have that there exists a closed set $F_0$ contained in $E$ such that
        \[
            \{f_n\}\to f\text{ uniformly on }F_0\text{ and }m(E\setminus F_0)<\epsilon/2.    
        \]
        We define $F=\bigcap_{n=0}^\infty F_n$, which is closed because it is an intersection of closed sets.
        Then we see that
        \begin{align*}
            m(E\setminus F)&=m(E\cap\biggr[\bigcup_{n=0}^\infty F_n^c\biggl])\\
            &=m(\bigcup_{n=0}^\infty [E\cap F_n^c])\\
            &=m([E\cap F_0^c]\cup\bigcup_{n=1}^\infty [E\cap F_n^c])\\
            &=m([E\setminus F_0]\cup\bigcup_{n=1}^\infty [E\setminus F_n])\\
            &\le m([E\setminus F_0])+\sum_{n=1}^\infty m( E\setminus F_n)\\
            &<\epsilon/2+\sum_{n=1}^\infty\epsilon/2^{n+1}\\
            &=\epsilon.
        \end{align*}
        Each $f_n$ is continuous on $F$ since $F\subseteq F_n$ and $f_n=g_n$ on $F_n$.
        \\Also, $\{f_n\}$ converges to $f$ uniformly on $F$ since $F\subseteq F_0$. 
        \\Then we can use the fact that because $\{f_n\}$ is a sequence of continuous functions on $F$ that converges uniformly on $F$ to $f$, then $f$ is continuous on $F$ as well.
        \\Finally see problem 25 to see that there exists a continuous function $g$ that extends $f$ to all of $\mathbb{R}$.
        Then $f=g$ on $F$ and $m(E\setminus F)<\epsilon$.
    \end{proof}
\end{flushleft}
\begin{center}
	\textbf{PROBLEMS}
\end{center}
\begin{enumerate}
	\setcounter{enumi}{24}
    \item Suppose $f$ is a function that is continuous on a closed set $F$ of real numbers. Show that $f$ has a continuous extension to all of $\mathbb{R}$. This is a special case of the forthcoming Tietze Extension Theorem.
    (Hint: express $\mathbb{R}\setminus F$ as the union of a countable disjoint collection of open intervals and define $f$ to be linear on the closure of each of these intervals.)\\
    \\(See Chapter 1 Problem 47.)
    \\Let $f$ be a function that is continuous on the closed set $F$.
    Consider the open set $F^c$.
    By Chapter 1 Proposition 9, this open  $F^c$ is the union of a countable, disjoint collection of intervals.
    \\In the case that $(-\infty,a)$ [or $(a,\infty)$] is in $F^c$, then $a \in F$ and $f(a)$ is defined.
	Simply let $f(x)=f(a)$ be the constant function on $(-\infty,a)$ [or $(a,\infty)$].
	\\In the case that $(a,b) \in F^c$, then $a,b\in F$ and $f(a)$,$f(b)$ are defined.
	Let 
	\[
		f(x)=\frac{f(b)-f(a)}{b-a}(x-a)+f(a)\text{ on } (a,b).
	\]
    Then we see that the extension of $f$ is continuous on $\mathbb{R}$.
    \item For the function $f$ and the set $F$ in the statement of Lusin's Theorem, show that the restriction of $f$ to $F$ is a continuous function.
    Must there be any points at which $f$, considered as a function of $E$, is continuous?\\
    \\See the proof for Lusin's Theorem; because $\{f_n\}$ is a sequence of continuous functions on $F$ that converges uniformly on $F$ to $f$, then $f$ is continuous on $F$ as well.
    \item Show that the conclusion of Egoroff's Theorem can fail if we drop the assumption that the domain has finite measure.\\
    \\Going back to the proof for Egoroff's Theorem, we see that we used the excision property:
    \begin{align*}
        m(E\setminus F)&=m(E)-m(F)&&\text{by excision}\\
        &= m(E)-m(A)+m(A)-m(F)\\
        &=m(E\setminus A)+m(A\setminus F)&&\text{by excision}\\
        &<\epsilon/2+\epsilon/2\\
        &=\epsilon.
    \end{align*}
    The excision property requires that
    \begin{align*}
        m(E\setminus F)&=m(E)-m(F)&&\text{if }m(F)<\infty\text{ and }F\subseteq E\\
        m(E\setminus A)&=m(E)-m(A)&&\text{if }m(A)<\infty\text{ and }A\subseteq E\\
        m(A\setminus F)&=m(A)-m(F)&&\text{if }m(F)<\infty\text{ and }F\subseteq A
    \end{align*}
    Specifically, we needed that $m(A),m(F)<\infty$. This was only possible because we assumed $m(E)<\infty$.
    \item Show that Egoroff's Theorem continues to hold if the convergence is pointwise a.e. and $f$ is finite a.e.\\
    \\In Lemma 10 on the way to proving Egoroff's Theorem, we used Proposition 9, which only requires the convergence to be pointwise a.e.
    \\In Lemma 10 we also used Theorem 6, which only requires $f_n$ and $f$ to be finite a.e. 
    \item Prove the extension of Lusin's Theorem to the case that $E$ has infinite measure.\\
    \\We needed to assume that $E$ had finite measure because we used Egoroff's Theorem in the proof for Lusin's Theorem, which requires finite measure (Problem 27).
    \item Prove the extension of Lusin's Theorem to the case that $f$ is not necessarily real-valued, but is finite a.e.\\
    \\We needed to assume that $f$ was real valued because we used Egoroff's Theorem in the proof for Lusin's Theorem, which requires $f$ to be real-valued.
    However, we showed that Egoroff's Theorem continues to hold if $f$ is finite a.e. (Problem 28).
    \item Let $\{f_n\}$ be a sequence of measurable functions on $E$ that converges to the real-valued $f$ pointwise on $E$. 
    Show that $E=\bigcup_{k=1}^\infty E_k$, where for each index $k$, $E_k$ is measurable, and $\{f_n\}$ converges uniformly to $f$ on each $E_k$ if $k>1$, and $m(E_1)=0$.\\
    \\Use Egoroff's Theorem.
\end{enumerate}